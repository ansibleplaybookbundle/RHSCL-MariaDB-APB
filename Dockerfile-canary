FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAKbmFtZTogbWFyaWFkYi1hcGIKZGVzY3JpcHRpb246IE1hcmlhZGIg\
YXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOgog\
IC0gZGF0YWJhc2UKICAtIG1hcmlhZGIKbWV0YWRhdGE6CiAgZG9jdW1lbnRhdGlvblVybDogImh0\
dHBzOi8vbWFyaWFkYi5jb20va2IvZW4vbWFyaWFkYi9kb2N1bWVudGF0aW9uLyIKICBsb25nRGVz\
Y3JpcHRpb246ICJEZXBsb3lzIGEgYmluZGFibGUgbWFyaWFkYiBpbnN0YW5jZSIKICBkZXBlbmRl\
bmNpZXM6CiAgICAtICdkb2NrZXIuaW8vY2VudG9zL21hcmlhZGItMTAxLWNlbnRvczcnCiAgICAt\
ICdkb2NrZXIuaW8vY2VudG9zL21hcmlhZGItMTAyLWNlbnRvczcnCiAgZGlzcGxheU5hbWU6ICJN\
YXJpYURCIChBUEIpIgogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1tYXJp\
YWRiCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgogIC0gbmFt\
ZTogZGV2CiAgICBkZXNjcmlwdGlvbjoKICAgICAgVGhpcyBwbGFuIGRlcGxveXMgYSBzaW5nbGUg\
TWFyaWFEQiBpbnN0YW5jZSB3aXRoIGVwaGVtZXJhbCBzdG9yYWdlCiAgICBmcmVlOiB0cnVlCiAg\
ICBkZWZhdWx0OiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERldmVsb3Bt\
ZW50CiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IG1hcmlh\
ZGJfZGF0YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIGRlc2NyaXB0aW9uOiBNYXJpYURCIGRlZmF1bHQgZGF0YWJhc2UgbmFtZQogICAgICAg\
IHRpdGxlOiBNYXJpYURCIERhdGFiYXNlIE5hbWUKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVow\
LTlfXSpbYS16QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgLSBuYW1lOiBtYXJpYWRiX3Jvb3RfcGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ICB0aXRsZTogTWFyaWFEQiBSb290IFBhc3N3b3JkCiAgICAgIC0gbmFtZTogbWFyaWFkYl91c2Vy\
CiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBwYXR0\
ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgcmVx\
dWlyZWQ6IHRydWUKICAgICAgICB0aXRsZTogTWFyaWFEQiBVc2VyCiAgICAgIC0gbmFtZTogbWFy\
aWFkYl9wYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVl\
CiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHRpdGxlOiBNYXJpYURCIFBh\
c3N3b3JkCiAgICAgIC0gbmFtZTogbWFyaWFkYl92ZXJzaW9uCiAgICAgICAgZGVmYXVsdDogIjEw\
LjIiCiAgICAgICAgZW51bTogWycxMC4yJywgJzEwLjEnXQogICAgICAgIHR5cGU6IGVudW0KICAg\
ICAgICB0aXRsZTogTWFyaWFEQiBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ICB1cGRhdGFibGU6IHRydWUKICAgIHVwZGF0ZXNfdG86CiAgICAgIC0gcHJvZAogIC0gbmFtZTog\
cHJvZAogICAgZGVzY3JpcHRpb246CiAgICAgIFRoaXMgcGxhbiBkZXBsb3lzIGEgc2luZ2xlIE1h\
cmlhREIgaW5zdGFuY2Ugd2l0aCBwZXJzaXN0ZW50IHN0b3JhZ2UKICAgIGZyZWU6IHRydWUKICAg\
IG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogUHJvZHVjdGlvbgogICAgICBjb3N0OiAkMC4w\
MAogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBtYXJpYWRiX2RhdGFiYXNlCiAgICAgICAg\
ZGVmYXVsdDogYWRtaW4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZXNjcmlwdGlvbjog\
TWFyaWFEQiBkZWZhdWx0IGRhdGFiYXNlIG5hbWUKICAgICAgICB0aXRsZTogTWFyaWFEQiBEYXRh\
YmFzZSBOYW1lCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEtWl9dK1thLXpB\
LVowLTlfXSokIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogbWFyaWFkYl9y\
b290X3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiBw\
YXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdGl0bGU6IE1hcmlhREIgUm9v\
dCBQYXNzd29yZAogICAgICAtIG5hbWU6IG1hcmlhZGJfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFk\
bWluCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10q\
W2EtekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAg\
dGl0bGU6IE1hcmlhREIgVXNlcgogICAgICAtIG5hbWU6IG1hcmlhZGJfcGFzc3dvcmQKICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlw\
ZTogcGFzc3dvcmQKICAgICAgICB0aXRsZTogTWFyaWFEQiBQYXNzd29yZAogICAgICAtIG5hbWU6\
IG1hcmlhZGJfdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6ICIxMC4yIgogICAgICAgIGVudW06IFsn\
MTAuMicsICcxMC4xJ10KICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgdGl0bGU6IE1hcmlhREIg\
VmVyc2lvbgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdXBkYXRhYmxlOiB0cnVlCiAg\
ICAgIC0gbmFtZTogbWFyaWFkYl92b2x1bWVfc2l6ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAg\
ICBkZWZhdWx0OiAnMUdpJwogICAgICAgIGVudW06IFsnMUdpJywgJzVHaScsICcxMEdpJ10KICAg\
ICAgICB0aXRsZTogTWFyaWFEQiBWb2x1bWUgU2l6ZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAg\
ICB1cGRhdGVzX3RvOgogICAgICAtIGRldgo="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/mariadb-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
